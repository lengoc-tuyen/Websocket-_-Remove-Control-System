<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>Nh·∫≠p IP ‚Äì Christmas LAN Remote</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            height: 100vh;
            background: url("image/door-bg.jpg") center/cover no-repeat fixed;
            font-family: system-ui, "Segoe UI", sans-serif;
            position: relative;
            overflow: hidden;
        }

        /* L·ªõp ph·ªß m·ªù cho n·ªÅn */
        body::before {
            content:"";
            position:fixed;
            inset:0;
            background: radial-gradient(circle at top, rgba(15,23,42,0.25), rgba(15,23,42,0.6));
            pointer-events:none;
            z-index:0;
        }

        /* Wreath-wrap ƒë·∫∑t c·ªë ƒë·ªãnh ƒë√∫ng v·ªã tr√≠ v√≤ng hoa tr√™n c·ª≠a */
        .wreath-wrap {
            position: fixed;
            top: 26vh;          /* ch·ªânh cao/th·∫•p v√≤ng hoa ·ªü ƒë√¢y */
            left: 50%;
            transform: translateX(-50%);
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            z-index: 2;
        }

        /* V√≤ng hoa */
        .wreath {
            width: 260px;
            height: 260px;
            background: url("image/wreath.png") center/contain no-repeat;
            position: relative;
            display:flex;
            align-items:center;
            justify-content:center;
            filter: drop-shadow(0 10px 25px rgba(0,0,0,0.7));
            animation: leds 2.2s ease-in-out infinite, wreath-drop 0.8s ease-out;
        }

        /* LED nh·∫•p nh√°y */
        @keyframes leds {
            0%, 100% { filter: drop-shadow(0 8px 22px rgba(239,68,68,0.7)); }
            50%      { filter: drop-shadow(0 8px 26px rgba(250,204,21,0.95)); }
        }

        /* V√≤ng hoa r∆°i xu·ªëng nh·∫π l√∫c load */
        @keyframes wreath-drop {
            0%   { transform: scale(0.7) translateY(-40px); opacity:0; }
            70%  { transform: scale(1.05) translateY(6px);  opacity:1; }
            100% { transform: scale(1)    translateY(0);    opacity:1; }
        }

        /* Form b√™n trong v√≤ng hoa */
        .wreath-inner {
            display:flex;
            flex-direction:column;
            align-items:center;
            gap:10px;
            transform: translateY(6px);
        }

        #ipInput {
            padding: 12px 10px;
            width: 185px;
            border-radius: 10px;
            border: 2px solid #ffffff;
            background: rgba(255,255,255,0.9);
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            outline: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        #ipInput::placeholder {
            color: #6b7280;
            font-weight: 500;
        }

        #connectBtn {
            width: 185px;
            padding: 9px;
            border-radius: 999px;
            font-size: 14px;
            font-weight: 700;
            background: #f97316;
            border:none;
            color:#111827;
            cursor:pointer;
            box-shadow:0 4px 14px rgba(0,0,0,0.5);
            transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
        }

        #connectBtn:hover {
            background:#fb923c;
            transform:translateY(-2px);
            box-shadow:0 6px 18px rgba(0,0,0,0.7);
        }

        #hint {
            margin-top: 6px;
            font-size: 12px;
            color:#e5e7eb;
            text-shadow:0 1px 3px rgba(0,0,0,0.8);
            text-align:center;
        }

        .bottom-links {
            position: fixed;
            bottom: 10px;
            left: 0;
            right: 0;
            text-align: center;
            z-index: 2;
            font-size: 12px;
            color:#e5e7eb;
            text-shadow:0 1px 3px rgba(0,0,0,0.8);
        }

        /* Tuy·∫øt r∆°i */
        .snowflake {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1;
            animation: snow-spin 6s linear infinite;
        }

        @keyframes snow-spin {
            from { transform: rotate(0deg); }
            to   { transform: rotate(360deg); }
        }

        /* Hi·ªáu ·ª©ng m·ªü c·ª≠a khi connect */
        body.door-opening .wreath-wrap .wreath {
            animation: wreath-zoom 0.9s ease-in forwards;
        }

        @keyframes wreath-zoom {
            0%   { transform: scale(1) translateY(0);    opacity:1; }
            40%  { transform: scale(1.15) translateY(-10px); }
            100% { transform: scale(0.4) translateY(-120px); opacity:0; }
        }

        body.door-opening::before {
            animation: fadeout-bg 0.9s ease-in forwards;
        }

        @keyframes fadeout-bg {
            0%   { background: radial-gradient(circle at top, rgba(15,23,42,0.25), rgba(15,23,42,0.6)); }
            100% { background: rgba(15,23,42,1); }
        }

        /* Responsive: m√†n nh·ªè h·∫° v√≤ng hoa th·∫•p h∆°n x√≠u & thu nh·ªè */
        @media (max-width: 768px) {
            .wreath-wrap { top: 22vh; }
            .wreath { width: 220px; height: 220px; }
        }
    </style>

<!-- Snowman Chatbot CSS -->
<link rel="stylesheet" href="Chatbot/chatbot.css">
</head>
<body>

<div class="wreath-wrap">
    <div class="wreath">
        <div class="wreath-inner">
            <input type="text" id="ipInput" placeholder="192.168.1.10:3000" />
            <button id="connectBtn">K·∫øt n·ªëi üéÑ</button>
            <div id="hint">Nh·∫≠p IP server / agent trong LAN</div>
        </div>
    </div>
</div>

<div class="bottom-links">
    ¬© ƒê·ªì √°n M·∫°ng M√°y T√≠nh ‚Äì Christmas LAN Remote ‚ùÑ
</div>

<audio id="bellSound" src="bell.mp3" preload="auto"></audio>

<script>
    // ‚ùÑ Tuy·∫øt r∆°i v·ªõi snow.png
    (function createSnow() {
        const numFlakes = 30;
        const flakes = [];
        const w = window.innerWidth;
        const h = window.innerHeight;

        for (let i = 0; i < numFlakes; i++) {
            const img = document.createElement("img");
            img.src = "image/snow.png";
            img.className = "snowflake";

            const size = Math.random() * 25 + 20; // 20‚Äì45px
            img.style.width = size + "px";

            img.style.top = Math.random() * h + "px";
            img.style.left = Math.random() * w + "px";
            img.style.opacity = (Math.random() * 0.7 + 0.3).toString();

            document.body.appendChild(img);
            flakes.push({
                el: img,
                speed: Math.random() * 1.5 + 0.5,
                drift: Math.random() * 0.6 + 0.2
            });
        }

        function animate() {
            const h = window.innerHeight;
            const w = window.innerWidth;

            flakes.forEach(flake => {
                let top = parseFloat(flake.el.style.top);
                let left = parseFloat(flake.el.style.left);

                top += flake.speed;
                left += Math.sin(top / 40) * flake.drift;

                if (top > h) {
                    top = -50;
                    left = Math.random() * w;
                }

                flake.el.style.top = top + "px";
                flake.el.style.left = left + "px";
            });

            requestAnimationFrame(animate);
        }

        animate();
    })();

    // üéÑ X·ª≠ l√Ω connect
    const btn = document.getElementById("connectBtn");
    const ipInput = document.getElementById("ipInput");
    const bell = document.getElementById("bellSound");

    btn.addEventListener("click", () => {
        const ip = ipInput.value.trim();
        if (!ip) {
            alert("H√£y nh·∫≠p ƒë·ªãa ch·ªâ IP trong m·∫°ng LAN!");
            ipInput.focus();
            return;
        }

        localStorage.setItem("remote_ip_config", ip);

        try { bell.currentTime = 0; bell.play(); } catch (e) {}

        document.body.classList.add("door-opening");

        setTimeout(() => {
            window.location.href = "MainWeb/index.html";
        }, 900);
    });

    ipInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") btn.click();
    });
</script>

<!-- Snowman Chatbot -->
<div id="snowman-chatbot">
    <div id="snowmanBubble" class="chat-bubble">Xin ch√†o</div>
    <img src="giphy.gif" alt="Snowman Chatbot" class="snowman-img" id="snowman-img">
</div>

<!-- Chat Window -->
<div id="chat-window">
    <div class="chat-header">
        <span>‚òÉÔ∏è Snowman AI</span>
        <button onclick="toggleChat()">‚úï</button>
    </div>

    <div class="chat-body" id="chat-messages">
        <div class="msg-bot">M√¨nh c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n? üéÑ</div>
    </div>

    <div class="chat-input-area">
        <input id="chat-input" type="text" placeholder="H·ªèi g√¨ ƒë√≥..." />
        <button onclick="sendChatUI()">G·ª≠i</button>
    </div>
</div>

<!-- API Config (load ƒë·∫ßu ti√™n) -->
<script type="module" src="Chatbot/config.js"></script>

<!-- AI Script (ph·∫£i load tr∆∞·ªõc) -->
<script type="module" src="Chatbot/InforOfChatBot.js"></script>

<!-- Snowman Chatbot Script -->
<script src="Chatbot/chatbot.js"></script>

</body>
</html>
